window.DesignIO=function(){function DesignIO(a){a||(a={}),this.port=a.port||4181,this.url=a.url||"http://localhost:"+this.port,this.socket=io.connect(this.url),this.callbacks={},this.stylesheets={},this.javascripts={},this.watchers=[],this.connect()}return DesignIO.prototype.connect=function(){var a,b;return b=this.socket,a=this,b.on("connect",function(){return b.emit("userAgent",a.userAgent()),b.on("watch",function(b){return a.watch(b)}),b.on("change",function(b){return a.change(b)})})},DesignIO.prototype.on=function(a,b){return this.callbacks[a]=b},DesignIO.prototype.runCallback=function(a,b){return this.callbacks[a]&&this.callbacks[a](b),!0},DesignIO.prototype.watch=function(data){var action,actions,pattern,patterns,watcher,_i,_j,_len,_len2,_ref;watcher={},actions=["create","update","delete"];for(_i=0,_len=actions.length;_i<_len;_i++)action=actions[_i],data.hasOwnProperty(action)&&(watcher[action]=eval("("+data[action]+")"));patterns=[],_ref=data.patterns;for(_j=0,_len2=_ref.length;_j<_len2;_j++)pattern=_ref[_j],patterns.push(new RegExp(pattern.pattern,pattern.options));return watcher.patterns=patterns,watcher.match=function(a){var b,c,d,e;e=this.patterns;for(c=0,d=e.length;c<d;c++){b=e[c];if(b.exec(a))return!0}return!1},this.watchers.push(watcher),this.runCallback("watch",data)},DesignIO.prototype.change=function(a){var b,c,d,e;c=this.watchers;for(d=0,e=c.length;d<e;d++)b=c[d],b.match(a.path)&&b.hasOwnProperty(a.action)&&b[a.action].call(window,a);return this.runCallback("change",a)},DesignIO.prototype.userAgent=function(){return{userAgent:window.navigator.userAgent,url:window.location.href}},DesignIO}()