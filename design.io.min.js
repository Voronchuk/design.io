window.DesignIO=function(){function DesignIO(a){a||(a={}),this.callbacks={},this.stylesheets={},this.javascripts={},this.watchers=[],this.port=a.port||4181,this.url=a.url||""+window.location.protocol+"://"+window.location.hostname+":"+this.port,this.socket=io.connect(this.url),this.connect()}return DesignIO.prototype.connect=function(){var a,b;return b=this.socket,a=this,b.on("connect",function(){return b.emit("userAgent",a.userAgent()),b.on("watch",function(b){return a.watch(b)}),b.on("exec",function(b){return a.exec(b)})})},DesignIO.prototype.on=function(a,b){return this.callbacks[a]=b},DesignIO.prototype.runCallback=function(a,b){return this.callbacks[a]&&this.callbacks[a].call(this,b),!0},DesignIO.prototype.watch=function(data){var action,actions,i,pattern,watcher,watchers,_i,_j,_len,_len2,_len3,_ref;watchers=data.body,actions=["create","update","delete"];for(_i=0,_len=watchers.length;_i<_len;_i++){watcher=watchers[_i],watcher.match=eval(watcher.match);for(_j=0,_len2=actions.length;_j<_len2;_j++)action=actions[_j],watcher.hasOwnProperty(action)&&(watcher[action]=eval(watcher[action]));_ref=watcher.patterns;for(i=0,_len3=_ref.length;i<_len3;i++)pattern=_ref[i],watcher.patterns[i]=new RegExp(pattern.source,pattern.options)}return this.watchers=watchers},DesignIO.prototype.exec=function(a){var b,c,d,e;c=this.watchers;for(d=0,e=c.length;d<e;d++)b=c[d],b.match(a.path)&&b.hasOwnProperty(a.action)&&b[a.action].call(this,a);return this.runCallback(a.action,a)},DesignIO.prototype.log=function(a){return typeof a=="object"&&(a.userAgent=window.navigator.userAgent,a.url=window.location.href),this.socket.emit("log",a)},DesignIO.prototype.userAgent=function(){return{userAgent:window.navigator.userAgent,url:window.location.href}},DesignIO}()